<!DOCTYPE html>
<html>
  <head>
    <title>The Transport Tycoon Kata</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <style type="text/css">
      @import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);
      body {
        font-family: 'Droid Serif';
      }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: 400;
        margin-bottom: 0;
      }
      .remark-slide-content h1 { font-size: 3em; }
      .remark-slide-content h2 { font-size: 2em; }
      .remark-slide-content h3 { font-size: 1.6em; }
      .footnote {
        position: absolute;
        bottom: 3em;
      }
      li p { line-height: 1.25em; }
      .red { color: #fa0000; }
      .large { font-size: 2em; }
      a, a > code {
        color: rgb(249, 38, 114);
        text-decoration: none;
      }
      code {
        background: #e7e8e2;
        border-radius: 5px;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      .remark-code-line-highlighted     { background-color: #373832; }
      .pull-left {
        float: left;
        width: 47%;
      }
      .pull-right {
        float: right;
        width: 47%;
      }
      .pull-right ~ p {
        clear: both;
      }
      #slideshow .slide .content code {
        font-size: 0.8em;
      }
      #slideshow .slide .content pre code {
        font-size: 0.9em;
        padding: 15px;
      }
      .inverse {
        background: #272822;
        color: #777872;
        text-shadow: 0 0 20px #333;
      }
      .inverse h1, .inverse h2 {
        color: #f3f3f3;
        line-height: 0.8em;
      }

      img {
        width:100%
      }
      .max img {
        width:auto;
        max-height: 200px;
      }

      blockquote {
        border-left: 0.3em solid #ccc;
        padding: 0 15px;
        font-style: italic;
        color: rgb(36, 36, 36);
        quotes: "\201C""\201D""\2018""\2019";
      }

      blockquote::after {
        content: close-quote;
        margin-left: 5px;
        font-size: 1.2em;
      }

      #the-transport-tyccon-kata{
        padding:5px;
        background-color: white;

      }

      table {
        margin:auto;
        padding-top: 50px;
      }
      td {
        padding:5px;
      }

      .twitter {
        color: rgb(29, 161, 242);
      }

      .textile {
        font-size: larger;
      }
    </style>
  </head>
  <body>
    <textarea id="source">
name: inverse
layout: true
class: center, middle, inverse
---

class: center, middle, inverse

# Transport Tycoon Kata

---
layout: false

# Agenda

- Introduction - why are we here?
- What's this Transport Tycoon thing?

- Exercise
  - Short Retrospective

- Exercise
  - Short Retrospective

???

~10 min
~10 min

~40 min
~10 min

~40 min
~10 min

---

# Hi I'm Christian .twitter[@Folienmaster]

--

- Software Developer and Consultant

--

- DDD practitioner

--

- I like to do Katas and Dojos

---

# I'm with .twitter[@Softwarepark]

- We are a distributed company (with a nucleus in Austria)

--

- We are flanking the EU from two sides: from the Ural to the UK

--

- We focus on quality, we seek challenging domains and we develop our skills together

--

- But: Maintaining a company ethos & spirit is hard

---

# Maintaining a company ethos is hard

--

- One of the reason for the Transport Tycoon Kata

--

- Have a way to practice, colaborate and learn from each other

--
  - Strengthen our values

--

- Share common practices and approaches with new hires

--

- Created by my two colleagues Rinat .twitter[@abdullin] and Peter .twitter[@pepperonee13]

---
   
# Why Katas?

--

- Safe place outside of work

--

- Deliberate Practice

--

- Relax and Slow down

--

- Learn from each other

---

# Away from the daily routine

--

- We are here to learn and experiment

--

- Be open for new experiences

--

- Practice coding and modelling
 
--

- No focus on finishing the task at hand

???

Mention that it's OK to be frustrated
- you are doing something new
- you are out of your comfort zone
- you work with strangers

---

background-image: url(images/tt-1-openttd.png)

# The Transport Tyccon Kata

<blockquote style="background-color: white;">
  This is a set of Domain-Driven Design (DDD) exercises. They take place in the universe of the <a href="https://en.wikipedia.org/wiki/Transport_Tycoon">Transport Tycoon</a>. It is a game "in which the player acts as an entrepreneur in control of a transport company, and can compete against rival companies to make as much profit as possible by transporting passengers and various goods by road, rail, sea and air."
</blockquote>

---

# The Transport Tyccon Kata

- Several levels (3 are available, 1 in the pipeline)
  - They build on each other

- Each of them should be doable in ~1 hour

- Available on [https://github.com/Softwarepark/exercises](https://github.com/Softwarepark/exercises/blob/master/transport-tycoon.md)

- Share your solutions!

---

# The Transport Tycoon Kata

<blockquote>
  There is a map containing a Factory, Port, Warehouse A and Warehouse B. Factory has a small stock of containers that have to be delivered to these warehouses warehouses in a predefined order.
</blockquote>

.center[![tt-1-exercise.png](images/tt-1-map.png)]

???

There are two trucks and one ship that can carry one container at a time (trucks start at Factory, ship starts at the Port).

Traveling takes a specific amount of hours (represented by an orange number). Time is needed to travel in one direction, you also spend the same amount of time to come back. For example, it takes 5 hours for a truck to travel from the Factory to B.

Transport follows a simple heuristic: pick the first container from the location (first-in, first - out), bring it to the designation, then come back home.

Truck that drops off cargo at the Port doesn't need to wait for the ship (there is a small warehouse buffer there). It can drop the cargo and start heading back. Cargo loading and unloading is an instant operation.

Transport moves in parallel. First truck might be bringing container to a location A, while the second truck comes back from A, while ship travels back to the Port.

---

# How long does it take to fullfil an order?
  
.center[![tt-1-exercise.png](images/tt-1-exercise.png)]

???

Switch to [visualization](https://htmlpreview.github.io/?https://github.com/Nagelfar/transport-tycoon/blob/enhancements/transport_visulazation/index.html?speed=0.05&scenario=outputs%2FABB.log&showLogs=false)!



---

# First exercise - Task

Write a program that takes a list of cargos from the command line and prints out the number of hours that it would take to get them delivered.

--

| Input        | Output |
| ------------ | ------ |
| A            | 5      |
| AB           | 5      |
| BB           | 5      |
| ABB          | 7      |
| AABABBAB     | **?**  |
| ABBBABAAABBB | **?**  |

---

# First exercise - Notes

- Don't worry about making the code extensible, **we will evolve the codebase**

- While picking the language for the exercise, pick whatever that would let you **solve the problem quicker**

- Remember that all processes happen in parallel. Trucks and ship would be moving around the map at the same time, not sequentially.

- Don't worry about applying any patterns (e.g. aggregates or events) at this point. Just **get the job done**

- If you donâ€™t make any progress in the beginning, try to **reduce the problem** to a simpler case and work from there.

---

# Now what?

- Choose a pairing partner or form small groups (3 - 4 people)

???

- do mob programming?
- do modelling in small groups, implement approaches parallel


--

- Decide on approach and language

---

# Approach and language?

You don't have to code right away!

--

- do Event Storming

--

- do Example Mapping

--

- do some Modelling

--

- do ...?

--

.center[But remember: the domain expert is a scarce resource!]

???

Mention that TDD is not a must

---

# Now what?

- Choose a pairing partner or form small groups (3-4 people)

- Decide on approach and language

- Keep it simple for now 

--

- Start to work for ~40 minutes!

---

# Retro first exercise

- Approaches?

--

- Programming Languages?

--

- Problems?

--

- Learnings?

???

Was it hard to follow what happened?

How did you do debugging/testing?

---

# Second Exercise

- Open up the black box by introducing events

--

- Generate implementation independent tests

--

- Enhance debugging via visual tools

--

![tt-2-tracing-small.png](images/tt-2-tracing-small.png)

---

# Domain Events?

- Meaningful business events

--

  - Departing and arriving on a location

--
  
  - Loading and unloading cargo

--

- Write logs in a JSON format to a file

---

# Domain Events - Format

```textile
{
  "event": "DEPART",     # type entry: DEPART or ARRIVE
  "time": 0,             # time in hours
  "transport_id": 0,     # unique transport id
  "kind": "TRUCK",       # transport kind
  "location": "FACTORY", # current location
  "destination": "PORT", # destination (only for DEPART)
  "cargo": [             # array of cargo being carried
    {
      "cargo_id": 0,     # unique cargo id
      "destination": "A",# where should the cargo be delivered
      "origin": "FACTORY"# where it is originally from
    }
  ]
}
```

---

# Domain Events?

- Meaningful business events

  - Departing and arriving on a location

  - Loading and unloading cargo

- Write logs in a JSON format to a file

- Choose a filename according to the scenario

--
  - e.g. **AABABBAB**

![tt-2-AABABBAB.png](images/tt-2-AABABBAB.png)

--

- Compare with reference set (or other groups)

--
  - ~ Test

---

# Second Exercise - Tasks

- **Extend your solution** to print domain events.

--

- Run the domain event log through the `trace.py` converter and then **display in the Chrome Trace tool**

---

class: center, middle

# One more thing...

---


# Second Exercise - Tasks

- **Extend your solution** to print domain events.

- Run the domain event log through the `trace.py` converter and then **display in the Chrome Trace tool**


- Ship can **take up to 4 containers**, but is slower now
--

  - Ship takes 1 hour to load *all* cargo  

  - Ship takes 1 hour to unload *all* cargo

--
  - Ship takes **6 hours to travel** in each direction    

--
  - Note, that ship doesn't wait to be full in order to DEPART. It just LOADs the available cargo and leaves.

---

# Retrospective

- Domain Events?

- Extension?

- Visualization?

???

Where Domain Events hard to introduce?

Was the extension painful?

Visualization of any help?

Key message / takeaway?

---

# Share your results!

- Twitter .twitter[\#DDD_Kata]

- Add your solution via PR: [https://github.com/Softwarepark/exercises/tree/master/transport-tycoon](https://github.com/Softwarepark/exercises/tree/master/transport-tycoon)


    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js" type="text/javascript">
    </script>
    <!-- 
---

# Why 7 units for ABB?

.center.max[![tt-1-exercise.png](images/tt-1-map.png)]


--

| Time  | Truck 1  | Truck 2 | Ship |
| ------|----------|---------|------|
|  0    | loads & leaves for Port | loads & leaves for B | |
--
| 1     | arrives at Port, unloads & back to Factory |  | loads & leaves for A | 
--
| 2     | arrives at Factory, loads & leaves for B | | | 
--
| 5     | | Arrives at B, unloads & back to Factory | arrives at A, unloads & back to Port |
--
| 7     | Arrives at B, unloads & back to Factory | | | 

- 0: Truck 1 leaves for Port; Truck 2 leaves for B
--
- 1: Truck 1 arrives at Port, unloads and back to Factory; Ship leaves for A
--
- 2: Truck 1 arrives at Factory, loads and leaves for B
--
- 5: Truck 2 arrives at B, unloads and back to Factory; Ship arrives at A, unloads and back to Port
--
- 7: Truck 1 arrives at B, unloads and back to Factory -->
    <script type="text/javascript">
      var slideshow = remark.create();
    </script>
  </body>
</html>